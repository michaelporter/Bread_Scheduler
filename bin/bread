#!/usr/bin/env ruby

$: << File.join(File.dirname(__FILE__), "/..")

require 'config/gems'
require 'lib/bread.rb'
require 'lib/database_setup.rb'

class Scheduler < Thor
  desc 'new --name \'My Bread!\' --rise 120 --bake 30 --loaves 2', 'create a new bread'
  option :name; option :rise; option :bake; option :loaves
  def new
    puts "you created a bread with the following details:"

    @bread = Bread.new(options)
    @bread.describe_bread
    @bread.save
  end

  desc 'schedule --all | --breads "My Bread!" "White Bread" | --breads 1 2 3', 'create new schedule with given breads'
  option :all; option :breads, :type => :array
  def schedule
    if option[:all]
      db.execute "SELECT * from breads"
    elsif option[:breads]
      if option[:breads].first.is_a? String
        db.execute "SELECT * from breads where name IN (#{option[:breads]})"
      elsif option[:breads].first.is_a? Integer
        db.execute "SELECT * from breads where id IN (#{option[:breads]})"
      end
    end
  end

end

Scheduler.start(ARGV)
